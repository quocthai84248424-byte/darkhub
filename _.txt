--[[
    DARK HUB by ilovedog
    Dead Rail Ultimate Edition - V16 (CALLBACK FIXED)
    Note: "Vào Discord để lấy Key!"
    Status: SUPREME STABILITY
]]

local _0xL = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

-- [HỆ THỐNG BIẾN BẢO MẬT]
local Config = {
    BringItem = false, SelectedBring = "None",
    AutoFarmBond = false, AutoFarmMoney = false,
    FarmSpeed = 150, FakeName = false,
    SilentAim = false, Noclip = false, AntiAFK = false,
    ESP_Zombie = false, ESP_Werewolf = false, ESP_Vampire = false, ESP_Bandit = false, ESP_Items = false
}

local _0xM = {
    ["Vàng"] = "Gold", ["Bạc"] = "Silver", ["Súng"] = "Gun", ["Rìu"] = "Axe", 
    ["Kiếm"] = "Sword", ["Than"] = "Coal", ["Bom"] = "Bomb", ["Mặt nạ"] = "Mask", 
    ["Dầu của boss Tesla"] = "TeslaOil"
}

local _0xP = game:GetService("Players").LocalPlayer
local _0xS = {game:GetService("HttpService"), game:GetService("TeleportService"), game:GetService("RunService"), game:GetService("VirtualUser")}

-- [WINDOW SETUP]
local Window = _0xL:CreateWindow({
   Name = "DARK HUB :: VOID",
   LoadingTitle = "Fixing Callback Systems...",
   KeySystem = true,
   KeySettings = {
      Title = "Security Check",
      Subtitle = "Discord: DARK HUB",
      Note = "Vào Discord để lấy Key!",
      Key = {"AUTOCLICLFULL22"}
   }
})

-- [TABS]
local TabMain = Window:CreateTab("Main", "home")
local TabFarm = Window:CreateTab("Farm", "bolt")
local TabCB = Window:CreateTab("Combat", "target")
local TabVS = Window:CreateTab("Visuals", "eye")
local TabST = Window:CreateTab("Settings", "settings")

-- [TAB MAIN: BRING]
TabMain:CreateToggle({Name = "Kích hoạt Bring Item", Callback = function(v) Config.BringItem = v end})
TabMain:CreateDropdown({Name = "Danh sách vật phẩm", Options = {"None", "Vàng", "Bạc", "Súng", "Rìu", "Kiếm", "Than", "Bom", "Mặt nạ", "Dầu của boss Tesla"}, Callback = function(o) Config.SelectedBring = o[1] end})

-- [TAB FARM: AUTO FARM]
TabFarm:CreateToggle({Name = "Auto Farm Bond", Callback = function(v) Config.AutoFarmBond = v end})
TabFarm:CreateToggle({Name = "Auto Farm Tiền", Callback = function(v) Config.AutoFarmMoney = v end})

-- [TAB COMBAT: SILENT AIM]
TabCB:CreateToggle({Name = "Silent Aim", Callback = function(v) Config.SilentAim = v end})

-- [TAB VISUALS: ESP]
TabVS:CreateToggle({Name = "ESP Items (Bond)", Callback = function(v) Config.ESP_Items = v end})
TabVS:CreateToggle({Name = "ESP Entities", Callback = function(v) Config.ESP_Zombie = v; Config.ESP_Werewolf = v; Config.ESP_Vampire = v; Config.ESP_Bandit = v end})

-- [TAB SETTINGS: FIX DESTROY]
TabST:CreateButton({Name = "SERVER HOP (THỦ CÔNG)", Callback = function() 
    local s = _0xS[1]:JSONDecode(game:HttpGet("https://games.roblox.com/v1/games/"..game.PlaceId.."/servers/Public?limit=100")).data
    for _, v in pairs(s) do if v.playing < v.maxPlayers and v.id ~= game.JobId then _0xS[2]:TeleportToPlaceInstance(game.PlaceId, v.id) break end end
end})

TabST:CreateToggle({Name = "Anti-AFK Protocol", Callback = function(v) Config.AntiAFK = v end})
TabST:CreateToggle({Name = "Identity Spoof (hacker11111)", Callback = function(v) Config.FakeName = v end})
TabST:CreateButton({Name = "ACTIVATE FLY", Callback = function() loadstring(game:HttpGet("https://raw.githubusercontent.com/XNEOFF/FlyGuiV3/main/FlyGuiV3.lua"))() end})
TabST:CreateToggle({Name = "Noclip Mode", Callback = function(v) Config.Noclip = v end})

-- FIX LỖI CALLBACK TẠI ĐÂY: Sử dụng Rayfield:Dialog
TabST:CreateButton({
   Name = "DESTROY GUI",
   Callback = function()
       _0xL:CreateDialog({
           Title = "XÁC NHẬN TẮT",
           Content = "Bạn có chắc chắn muốn đóng Script không?",
           Buttons = {
               {
                   Text = "CÓ",
                   Callback = function()
                       _0xL:Notify({Title = "GOODBYE", Content = "Script đang đóng...", Duration = 3})
                       task.wait(1)
                       _0xL:Destroy()
                   end
               },
               {
                   Text = "KHÔNG",
                   Callback = function()
                       -- Không làm gì cả, bảng sẽ tự đóng
                   end
               }
           }
       })
   end,
})

-- [SYSTEM LOOPS - GIỮ NGUYÊN KHÔNG ĐỔI]
_0xS[3].RenderStepped:Connect(function()
    if Config.Noclip and _0xP.Character then
        for _, v in pairs(_0xP.Character:GetDescendants()) do if v:IsA("BasePart") then v.CanCollide = false end end
    end
end)

task.spawn(function()
    while true do task.wait(0.3)
        local r = _0xP.Character and _0xP.Character:FindFirstChild("HumanoidRootPart")
        if not r then continue end
        if Config.BringItem and Config.SelectedBring ~= "None" then
            local t = _0xM[Config.SelectedBring]
            for _, o in pairs(workspace:GetDescendants()) do
                if o.Name:lower():find(t:lower()) then
                    pcall(function() o.CFrame = r.CFrame * CFrame.new(0,-2,0) fireproximityprompt(o:FindFirstChildOfClass("ProximityPrompt") or o.Parent:FindFirstChildOfClass("ProximityPrompt")) end)
                end
            end
        end
        local ft = (Config.AutoFarmBond and "Bond") or (Config.AutoFarmMoney and "Gold")
        if ft then
            for _, v in pairs(workspace:GetDescendants()) do 
                if v.Name:find(ft) then 
                    r.CFrame = v.CFrame * CFrame.new(0,2,0)
                    fireproximityprompt(v:FindFirstChildOfClass("ProximityPrompt") or v.Parent:FindFirstChildOfClass("ProximityPrompt"))
                    break 
                end 
            end
        end
    end
end)

local mt = getrawmetatable(game); local old = mt.__index; setreadonly(mt, false)
mt.__index = newcclosure(function(t, k)
    if Config.FakeName and (k == "DisplayName" or k == "Name") and t == _0xP then return "hacker11111" end
    return old(t, k)
end); setreadonly(mt, true)

_0xL:LoadConfiguration()
