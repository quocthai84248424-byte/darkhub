--[[
    DARK HUB - ULTIMATE V26 (FLUENT UI + FIXED)
    LOGIC: Hutao Gen Detection + Instant Front-TP
    SPECIAL: FORCE AUTO-ENABLE (Vào game là tự chạy)
]]--

local Fluent = loadstring(game:HttpGet("https://github.com/dawid-scripts/Fluent/releases/latest/download/main.lua"))()

--// WHITELIST (HEX)
local _0xAUTH = {
    ["\104\105\101\117\122\101\100\48\53"] = true,
    ["\72\97\110\110\97\104\80\114\105\109\97\108\77\121\115\116\105\99"] = true
}

local _0xP = game:GetService("Players").LocalPlayer
if not _0xAUTH[_0xP.Name] then _0xP:Kick("Auth Failed") return end

--// AUTO SETTINGS
getgenv().Config = {
    AutoFarm = true, -- MẶC ĐỊNH BẬT
    Delay = 1.2,
    AutoHop = true
}

--// FORCE AUTO EXECUTE (HUTAO STYLE)
pcall(function()
    local qot = queue_on_teleport or (syn and syn.queue_on_teleport)
    if qot then
        qot([[
            task.wait(5)
            loadstring(game:HttpGet("https://raw.githubusercontent.com/hdksakst-ship-it/Hutao-Hub-Omega-X/refs/heads/main/Forsaken-v3.txt"))()
        ]])
    end
end end)

--// UI SETUP
local Window = Fluent:CreateWindow({
    Title = "DARK HUB V26 | FINAL VM",
    SubTitle = "by @bacon1607",
    TabWidth = 160, Size = UDim2.fromOffset(450, 320), Acrylic = true, Theme = "Dark"
})

local Tabs = { Farm = Window:AddTab({ Title = "Automation", Icon = "box" }) }

local FarmToggle = Tabs.Farm:AddToggle("AF", {Title = "Auto Fix Gen (Instant TP)", Default = true})
FarmToggle:OnChanged(function() getgenv().Config.AutoFarm = FarmToggle.Value end)

--// IDENTITY LOCK (@bacon1607)
task.spawn(function()
    while task.wait(0.5) do
        pcall(function()
            local n = "bacon1607"
            _0xP.DisplayName = n
            _0xP.Name = n
            if _0xP.Character and _0xP.Character:FindFirstChild("Humanoid") then
                _0xP.Character.Humanoid.DisplayName = n
            end
        end)
    end
end)

--// CORE: HUTAO SCANNER + TELEPORT
local function GetTarget()
    for _, v in pairs(workspace:GetDescendants()) do
        if v:IsA("ProximityPrompt") then
            local act = v.ActionText:lower()
            if act:find("repair") or act:find("fix") or v.ObjectText:lower():find("gen") then
                local m = v.Parent
                local p = m:FindFirstChild("Progress") or m:FindFirstChild("Value", true)
                if not p or (p and p.Value < 100) then
                    return {Model = m, Prompt = v, Progress = p}
                end
            end
        end
    end
    return nil
end

task.spawn(function()
    while true do
        task.wait(0.5)
        if getgenv().Config.AutoFarm then
            local target = GetTarget()
            if target then
                local hrp = _0xP.Character and _0xP.Character:FindFirstChild("HumanoidRootPart")
                if hrp then
                    local cf = target.Model:GetModelCFrame()
                    local tpPos = cf * CFrame.new(0, 0, -3.7) -- Đứng trước mặt máy

                    -- Instant Teleport
                    hrp.CFrame = CFrame.new(tpPos.Position, cf.Position)

                    while getgenv().Config.AutoFarm and (not target.Progress or target.Progress.Value < 100) do
                        hrp.CFrame = CFrame.new(tpPos.Position, cf.Position)
                        fireproximityprompt(target.Prompt)
                        task.wait(getgenv().Config.Delay)
                        if not target.Model:IsDescendantOf(workspace) then break end
                    end
                end
            elseif getgenv().Config.AutoHop then
                task.wait(2)
                game:GetService("TeleportService"):Teleport(game.PlaceId)
            end
        end
    end
end)

Fluent:Notify({ Title = "DARK HUB", Content = "Script đã nạp và TỰ ĐỘNG BẬT!", Duration = 5 })
